---
title: "Monitoring Subsurface CO~2~ Plumes with Sequential Bayesian Inference"
author:
  - name: Ting-Ying Yu
    orcid: "0009-0008-9481-4588"
    affiliations:
      name: Georgia Institute of Technology
  - name: Rafael Orozco
    affiliations:
      name: Georgia Institute of Technology
  - name: Ziyi Yin
    orcid: "0000-0002-5024-8771"
    email: ziyi.yin@gatech.edu
    url: https://ziyiyin97.github.io
    affiliations:
      name: Georgia Institute of Technology
      url: https://slim.gatech.edu/
  - name: Mathias Louboutin
    orcid: "0000-0002-1255-2107"
    email: mlouboutin3@gatech.edu
    url: https://mloubout.github.io
    affiliations:
      - name: Georgia Institute of Technology
        url: https://slim.gatech.edu/
  - name: Felix J. Herrmann
    orcid: "0000-0003-1180-2167"
    affiliations:
      - name: Georgia Institute of Technology
        url: https://slim.gatech.edu/
description: | 
 
bibliography: abstract.bib
abstract: |

---

::: hidden
$$
    \newcommand{\pluseq}{\mathrel{+}=}
$$
:::

## OBJECTIVES AND SCOPE 
<!-- (597/600 characters)  -->

To monitor and predict CO~2~ plume dynamics during geological carbon storage, reservoir engineers usually perform two-phase flow simulations. While these simulations may provide useful insights, their usefulness is limited due to numerous complicating factors including uncertainty in the dynamics of the plume itself. To study this phenomenon, we consider stochasticity in the dynamic caused by unknown random changes in the injection rate. By conditioning the CO~2~ plume predictions on seismic observations, we correct the CO~2~ plume predictions and quantify uncertainty with machine learning.

## METHODS, PROCEDURES, PROCESS 
<!-- (1443/1500 characters)  -->
We propose a method where at each timestep conditional neural networks are trained to generate samples of the CO~2~ saturation conditioned on current time-lapse seismic data. The method proceeds by generating training pairs consisting of the current CO~2~ saturation, which is simulated with a random injection rate from the previous timestep, and the associated reverse-time migration seismic image computed from simulated surface data. Given these training pairs, an amortized conditional normalizing flow (NF) is trained to approximate the posterior distribution for the saturation given seismic images. After training, the network is capable of drawing samples from the posterior distribution of the saturation given observed time-lapse seismic data at the current timestep. In turn, these samples for the CO~2~ saturation serve as input to two-phase flow simulations to predict the CO~2~ plume at the next timestep and the process repeats itself, recursively.

Compared to more traditional data assimilation techniques, our approach has the distinct advantage that it does not make simplifying assumptions on the statistics and linearity of the CO~2~ plume dynamics and its coupling to time-lapse seismic data. The proposed method is also likelihood free. It only needs to be able to run simulations of the plume dynamics that may contain hidden stochastic terms. In our case, this stochastic term is the randomly varying injection rate.


<!-- We generate the prior x_0, a dataset with 128 CO~2~ saturation data (x) each with a size of 64x64 . Each prior data has a circular initial CO~2~ plume with a uniformed CO~2~ saturation s \sim N(0.2,0.8). Besides the prior, two physics models, the transition model (M) and seismic observation model (H), are used for all experiments. The stochastic transition model to calculate the evolution of CO~2~ saturation data over each timestep with fluid flow physics with a randomized injection rate I \sim N(0,0.2). The seismic model made observations (y) based on the simulated acoustic measurements at the surface. 

The ground truth is generated by randomly sampling one CO~2~ saturation data (x^*) from the prior and transition over five timesteps. Seismic observations (\mathbf{y}^*) are made at each timestep. Two numerical experiments are performed to predict the ground truth: unconditioned simulation and seismic-conditioned simulation. 

The unconditioned simulation is performed to represent the current CO~2~ plume forecasting technique. The entire prior dataset is transitioned and seismically observed for five timesteps.

Our seismic-conditioned simulation involves four main processes: transitioning, seismic observation, Conditional Normalizing Flow (CNF) training, and posterior sampling (Figure 1). After the prior (x_{n}) is transitioned and seismically observed, the (x_{n+1},y_{n+1}) are the training pair  for Conditional Normalizing Flow, a generative network that can learn to sample from conditional distributions p(x|y). Therefore, we sample from the conditioned CNF-generated posterior on the round truth observation x_{n+1} \sim p(x|y=y_{n+1}^*. For sequential Bayesian inference, the posterior samples are served as the prior of the next timestep, so \mathbf{x}_{n+1} \sim p(x|y=y_{n+1}^*)) is transitioned to x_{n+2}.  -->

::: {#fig-1 layout-ncol=1}

![](figures/schematic.png){width=100%}

Schematic of training process for a single timestep. 

:::

## RESULTS, OBSERVATIONS, CONCLUSIONS 
<!-- (1199/1500 characters)  -->
We make CO~2~ plume predictions using both conditioned by seismic and unconditioned simulations. The conditional mean of the posterior samples is used for the seismic-conditioned predictions, while the unconditioned predictions are given by the ensemble mean over the different simulations at each timestep. Figure 2 shows that seismic-conditioned predictions are more accurate in predicting the ground truth and have a smaller conditional sample variance than the unconditioned ensemble mean predictions. 

By examining the difference between the ground truth and predictions, we characterize the uncertainties. For the seismic-conditioned predictions, the uncertainties are located near the injection well. In addition, the plume's boundary is well-predicted by the seismic-conditioned method while the unconditioned simulations have, as expected, an increasing uncertainty at the boundary over time and tend to consistently over-estimate the plume extent.

Overall, we conclude that the unconditioned simulation poorly predicts the CO~2~ plume. Our seismic-conditioned framework assimilates information and learns over time, which improves the CO~2~ forecasting and characterizes uncertainties. 

::: {#fig-2 layout-ncol=1}

![](figures/results.png){width=100%}

Results from our method compared with unconditional ensemble variogram.

:::

## SIGNIFICANCE/NOVELTY 
<!-- (429/600 characters)  -->
To our understanding, this framework is the first geological carbon storage monitoring model that continuously assimilates information with seismic observations, updates the CO~2~ plume predictions, and characterizes uncertainties on the plume itself. Because our predictions are conditioned by the physics, we expect this method to extend to larger and more realistic model sources of uncertainty (permeability, topology, etc).
